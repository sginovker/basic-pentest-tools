import argparse
import zipfile


# attempt to extract zip file with password
def extractFile(zfile, password: str):
    try:
        zfile.extractall(pwd=bytes(password, "utf-8"))
        return password
    except:
        return

# open zip file and guess passwords
def guessPasswords(zFilename: str, pwdFilename: str) -> None:
    zfile = zipfile.ZipFile(zFilename)
    passFile = open(pwdFilename)
    for line in passFile.readlines():
        password = line.strip('\n')
        guess = extractFile(zfile, password)
        if guess:
            print("Password = " + password)
            break

if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="Given a host name, scans host to see if anonymous FTP login is possible."
    )
    # add command line argument for host ip
    parser.add_argument("zFilename", help="the target zip file name")
    parser.add_argument("pwdFilename", help="the password list file name")

    args = parser.parse_args()

    guessPasswords(args.zFilename, args.pwdFilename)